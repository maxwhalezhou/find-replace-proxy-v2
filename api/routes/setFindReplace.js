var express = require('express');
var router = express.Router();
const sanitizer = require('sanitizer');
const { exec } = require('child_process');
const fs = require('fs');




router.post('/', function (req, res, next) {
    var findString = sanitizer.sanitize(req.body.findString);
    var replaceString = sanitizer.sanitize(req.body.replaceString);

    // var findString = "suckadick";
    // var replaceString = "noyousuckadick";

    //create burp Config file to run with
    var burpConfigFile = "{\r\n    \"project_options\":{\r\n        \"connections\":{\r\n            \"hostname_resolution\":[],\r\n            \"out_of_scope_requests\":{\r\n                \"advanced_mode\":false,\r\n                \"drop_all_out_of_scope\":false,\r\n                \"exclude\":[],\r\n                \"include\":[],\r\n                \"scope_option\":\"suite\"\r\n            },\r\n            \"platform_authentication\":{\r\n                \"credentials\":[],\r\n                \"do_platform_authentication\":true,\r\n                \"prompt_on_authentication_failure\":false,\r\n                \"use_user_options\":true\r\n            },\r\n            \"socks_proxy\":{\r\n                \"dns_over_socks\":false,\r\n                \"host\":\"\",\r\n                \"password\":\"\",\r\n                \"port\":0,\r\n                \"use_proxy\":false,\r\n                \"use_user_options\":true,\r\n                \"username\":\"\"\r\n            },\r\n            \"timeouts\":{\r\n                \"domain_name_resolution_timeout\":300000,\r\n                \"failed_domain_name_resolution_timeout\":60000,\r\n                \"normal_timeout\":120000,\r\n                \"open_ended_response_timeout\":10000\r\n            },\r\n            \"upstream_proxy\":{\r\n                \"servers\":[],\r\n                \"use_user_options\":true\r\n            }\r\n        },\r\n        \"http\":{\r\n            \"redirections\":{\r\n                \"understand_3xx_status_code\":true,\r\n                \"understand_any_status_code_with_location_header\":false,\r\n                \"understand_javascript_driven\":false,\r\n                \"understand_meta_refresh_tag\":true,\r\n                \"understand_refresh_header\":true\r\n            },\r\n            \"status_100_responses\":{\r\n                \"remove_100_continue_responses\":false,\r\n                \"understand_100_continue_responses\":true\r\n            },\r\n            \"streaming_responses\":{\r\n                \"scope_advanced_mode\":false,\r\n                \"store\":true,\r\n                \"strip_chunked_encoding_metadata\":true,\r\n                \"urls\":[]\r\n            }\r\n        },\r\n        \"misc\":{\r\n            \"logging\":{\r\n                \"requests\":{\r\n                    \"all_tools\":\"\",\r\n                    \"extender\":\"\",\r\n                    \"intruder\":\"\",\r\n                    \"proxy\":\"\",\r\n                    \"repeater\":\"\",\r\n                    \"scanner\":\"\",\r\n                    \"sequencer\":\"\",\r\n                    \"spider\":\"\"\r\n                },\r\n                \"responses\":{\r\n                    \"all_tools\":\"\",\r\n                    \"extender\":\"\",\r\n                    \"intruder\":\"\",\r\n                    \"proxy\":\"\",\r\n                    \"repeater\":\"\",\r\n                    \"scanner\":\"\",\r\n                    \"sequencer\":\"\",\r\n                    \"spider\":\"\"\r\n                }\r\n            }\r\n        },\r\n        \"sessions\":{\r\n            \"cookie_jar\":{\r\n                \"monitor_extender\":false,\r\n                \"monitor_intruder\":false,\r\n                \"monitor_proxy\":true,\r\n                \"monitor_repeater\":false,\r\n                \"monitor_scanner\":false,\r\n                \"monitor_sequencer\":false,\r\n                \"monitor_spider\":true\r\n            },\r\n            \"macros\":{\r\n                \"macros\":[]\r\n            },\r\n            \"session_handling_rules\":{\r\n                \"rules\":[\r\n                    {\r\n                        \"actions\":[\r\n                            {\r\n                                \"enabled\":true,\r\n                                \"match_cookies\":\"all_except\",\r\n                                \"type\":\"use_cookies\"\r\n                            }\r\n                        ],\r\n                        \"description\":\"Use cookies from Burp's cookie jar\",\r\n                        \"enabled\":true,\r\n                        \"exclude_from_scope\":[],\r\n                        \"include_in_scope\":[],\r\n                        \"named_params\":[],\r\n                        \"restrict_scope_to_named_params\":false,\r\n                        \"tools_scope\":[\r\n                            \"Spider\",\r\n                            \"Scanner\"\r\n                        ],\r\n                        \"url_scope\":\"all\",\r\n                        \"url_scope_advanced_mode\":false\r\n                    }\r\n                ]\r\n            }\r\n        },\r\n        \"ssl\":{\r\n            \"client_certificates\":{\r\n                \"certificates\":[],\r\n                \"use_user_options\":true\r\n            },\r\n            \"negotiation\":{\r\n                \"allow_unsafe_renegotiation\":false,\r\n                \"automatically_select_compatible_ssl_parameters_on_failure\":true,\r\n                \"disable_ssl_session_resume\":false,\r\n                \"enabled_ciphers\":[],\r\n                \"enabled_protocols\":[],\r\n                \"use_platform_default_protocols_and_ciphers\":true\r\n            }\r\n        }\r\n    },\r\n    \"proxy\":{\r\n        \"http_history_display_filter\":{\r\n            \"by_annotation\":{\r\n                \"show_only_commented_items\":false,\r\n                \"show_only_highlighted_items\":false\r\n            },\r\n            \"by_file_extension\":{\r\n                \"hide_items\":[\r\n                    \"js\",\r\n                    \"gif\",\r\n                    \"jpg\",\r\n                    \"png\",\r\n                    \"css\"\r\n                ],\r\n                \"hide_specific\":false,\r\n                \"show_items\":[\r\n                    \"asp\",\r\n                    \"aspx\",\r\n                    \"jsp\",\r\n                    \"php\"\r\n                ],\r\n                \"show_only_specific\":false\r\n            },\r\n            \"by_listener\":{\r\n                \"port\":\"\"\r\n            },\r\n            \"by_mime_type\":{\r\n                \"show_css\":false,\r\n                \"show_flash\":true,\r\n                \"show_html\":true,\r\n                \"show_images\":false,\r\n                \"show_other_binary\":false,\r\n                \"show_other_text\":true,\r\n                \"show_script\":true,\r\n                \"show_xml\":true\r\n            },\r\n            \"by_request_type\":{\r\n                \"hide_items_without_responses\":false,\r\n                \"show_only_in_scope_items\":false,\r\n                \"show_only_parameterized_requests\":false\r\n            },\r\n            \"by_status_code\":{\r\n                \"show_2xx\":true,\r\n                \"show_3xx\":true,\r\n                \"show_4xx\":true,\r\n                \"show_5xx\":true\r\n            }\r\n        },\r\n        \"intercept_client_requests\":{\r\n            \"automatically_fix_missing_or_superfluous_new_lines_at_end_of_request\":false,\r\n            \"automatically_update_content_length_header_when_the_request_is_edited\":true,\r\n            \"do_intercept\":true,\r\n            \"rules\":[\r\n                {\r\n                    \"boolean_operator\":\"and\",\r\n                    \"enabled\":true,\r\n                    \"match_condition\":\"(^gif$|^jpg$|^png$|^css$|^js$|^ico$)\",\r\n                    \"match_relationship\":\"does_not_match\",\r\n                    \"match_type\":\"file_extension\"\r\n                },\r\n                {\r\n                    \"boolean_operator\":\"or\",\r\n                    \"enabled\":false,\r\n                    \"match_relationship\":\"contains_parameters\",\r\n                    \"match_type\":\"request\"\r\n                },\r\n                {\r\n                    \"boolean_operator\":\"or\",\r\n                    \"enabled\":false,\r\n                    \"match_condition\":\"(get|post)\",\r\n                    \"match_relationship\":\"does_not_match\",\r\n                    \"match_type\":\"http_method\"\r\n                },\r\n                {\r\n                    \"boolean_operator\":\"and\",\r\n                    \"enabled\":false,\r\n                    \"match_relationship\":\"is_in_target_scope\",\r\n                    \"match_type\":\"url\"\r\n                }\r\n            ]\r\n        },\r\n        \"intercept_server_responses\":{\r\n            \"automatically_update_content_length_header_when_the_response_is_edited\":true,\r\n            \"do_intercept\":false,\r\n            \"rules\":[\r\n                {\r\n                    \"boolean_operator\":\"or\",\r\n                    \"enabled\":true,\r\n                    \"match_condition\":\"text\",\r\n                    \"match_relationship\":\"matches\",\r\n                    \"match_type\":\"content_type_header\"\r\n                },\r\n                {\r\n                    \"boolean_operator\":\"or\",\r\n                    \"enabled\":false,\r\n                    \"match_relationship\":\"was_modified\",\r\n                    \"match_type\":\"request\"\r\n                },\r\n                {\r\n                    \"boolean_operator\":\"or\",\r\n                    \"enabled\":false,\r\n                    \"match_relationship\":\"was_intercepted\",\r\n                    \"match_type\":\"request\"\r\n                },\r\n                {\r\n                    \"boolean_operator\":\"and\",\r\n                    \"enabled\":false,\r\n                    \"match_condition\":\"^304$\",\r\n                    \"match_relationship\":\"does_not_match\",\r\n                    \"match_type\":\"status_code\"\r\n                },\r\n                {\r\n                    \"boolean_operator\":\"and\",\r\n                    \"enabled\":false,\r\n                    \"match_relationship\":\"is_in_target_scope\",\r\n                    \"match_type\":\"url\"\r\n                }\r\n            ]\r\n        },\r\n        \"intercept_web_sockets_messages\":{\r\n            \"client_to_server_messages\":true,\r\n            \"server_to_client_messages\":true\r\n        },\r\n        \"match_replace_rules\":[\r\n            {\r\n                \"comment\":\"Emulate IE\",\r\n                \"enabled\":false,\r\n                \"is_simple_match\":false,\r\n                \"rule_type\":\"request_header\",\r\n                \"string_match\":\"^User-Agent.*$\",\r\n                \"string_replace\":\"User-Agent: Mozilla\/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\"\r\n            },\r\n            {\r\n                \"comment\":\"Emulate iOS\",\r\n                \"enabled\":false,\r\n                \"is_simple_match\":false,\r\n                \"rule_type\":\"request_header\",\r\n                \"string_match\":\"^User-Agent.*$\",\r\n                \"string_replace\":\"User-Agent: Mozilla\/5.0 (iPhone; CPU iPhone OS 5_1 like Mac OS X) AppleWebKit\/534.46 (KHTML, like Gecko) Version\/5.1 Mobile\/9B176 Safari\/7534.48.3\"\r\n            },\r\n            {\r\n                \"comment\":\"Emulate Android\",\r\n                \"enabled\":false,\r\n                \"is_simple_match\":false,\r\n                \"rule_type\":\"request_header\",\r\n                \"string_match\":\"^User-Agent.*$\",\r\n                \"string_replace\":\"User-Agent: Mozilla\/5.0 (Linux; U; Android 2.2; en-us; Droid Build\/FRG22D) AppleWebKit\/533.1 (KHTML, like Gecko) Version\/4.0 Mobile Safari\/533.1\"\r\n            },\r\n            {\r\n                \"comment\":\"Require non-cached response\",\r\n                \"enabled\":false,\r\n                \"is_simple_match\":false,\r\n                \"rule_type\":\"request_header\",\r\n                \"string_match\":\"^If-Modified-Since.*$\"\r\n            },\r\n            {\r\n                \"comment\":\"Require non-cached response\",\r\n                \"enabled\":false,\r\n                \"is_simple_match\":false,\r\n                \"rule_type\":\"request_header\",\r\n                \"string_match\":\"^If-None-Match.*$\"\r\n            },\r\n            {\r\n                \"comment\":\"Hide Referer header\",\r\n                \"enabled\":false,\r\n                \"is_simple_match\":false,\r\n                \"rule_type\":\"request_header\",\r\n                \"string_match\":\"^Referer.*$\"\r\n            },\r\n            {\r\n                \"comment\":\"Require non-compressed responses\",\r\n                \"enabled\":false,\r\n                \"is_simple_match\":false,\r\n                \"rule_type\":\"request_header\",\r\n                \"string_match\":\"^Accept-Encoding.*$\"\r\n            },\r\n            {\r\n                \"comment\":\"Ignore cookies\",\r\n                \"enabled\":false,\r\n                \"is_simple_match\":false,\r\n                \"rule_type\":\"response_header\",\r\n                \"string_match\":\"^Set-Cookie.*$\"\r\n            },\r\n            {\r\n                \"comment\":\"Rewrite Host header\",\r\n                \"enabled\":false,\r\n                \"is_simple_match\":false,\r\n                \"rule_type\":\"request_header\",\r\n                \"string_match\":\"^Host: foo.example.org$\",\r\n                \"string_replace\":\"Host: bar.example.org\"\r\n            },\r\n            {\r\n                \"comment\":\"Add spoofed CORS origin\",\r\n                \"enabled\":false,\r\n                \"is_simple_match\":true,\r\n                \"rule_type\":\"request_header\",\r\n                \"string_replace\":\"Origin: foo.example.org\"\r\n            },\r\n            {\r\n                \"comment\":\"Remove HSTS headers\",\r\n                \"enabled\":false,\r\n                \"is_simple_match\":false,\r\n                \"rule_type\":\"response_header\",\r\n                \"string_match\":\"^Strict\\\\-Transport\\\\-Security.*$\"\r\n            },\r\n            {\r\n                \"comment\":\"Disable browser XSS protection\",\r\n                \"enabled\":false,\r\n                \"is_simple_match\":true,\r\n                \"rule_type\":\"response_header\",\r\n                \"string_replace\":\"X-XSS-Protection: 0\"\r\n            },\r\n            {\r\n                \"enabled\":true,\r\n                \"is_simple_match\":true,\r\n                \"rule_type\":\"response_body\",\r\n                \"string_match\":\"" + findString + "\",\r\n                \"string_replace\":\"" + replaceString + "\"\r\n            }\r\n        ],\r\n        \"miscellaneous\":{\r\n            \"disable_logging_to_history_and_site_map\":false,\r\n            \"disable_out_of_scope_logging_to_history_and_site_map\":false,\r\n            \"disable_web_interface\":false,\r\n            \"remove_unsupported_encodings_from_accept_encoding_headers_in_incoming_requests\":true,\r\n            \"set_connection_close_header_on_requests\":true,\r\n            \"set_connection_close_header_on_responses\":false,\r\n            \"strip_proxy_headers_in_incoming_requests\":true,\r\n            \"strip_sec_websocket_extensions_headers_in_incoming_requests\":true,\r\n            \"suppress_burp_error_messages_in_browser\":false,\r\n            \"unpack_gzip_deflate_in_requests\":false,\r\n            \"unpack_gzip_deflate_in_responses\":true,\r\n            \"use_http_10_in_requests_to_server\":false,\r\n            \"use_http_10_in_responses_to_client\":false\r\n        },\r\n        \"request_listeners\":[\r\n            {\r\n                \"certificate_mode\":\"per_host\",\r\n                \"listen_mode\":\"loopback_only\",\r\n                \"listener_port\":8080,\r\n                \"running\":false\r\n            },\r\n            {\r\n                \"certificate_mode\":\"per_host\",\r\n                \"listen_mode\":\"specific_address\",\r\n                \"listen_specific_address\":\"10.138.0.2\",\r\n                \"listener_port\":8080,\r\n                \"running\":true\r\n            }\r\n        ],\r\n        \"response_modification\":{\r\n            \"convert_https_links_to_http\":false,\r\n            \"enable_disabled_form_fields\":false,\r\n            \"highlight_unhidden_fields\":false,\r\n            \"remove_all_javascript\":false,\r\n            \"remove_input_field_length_limits\":false,\r\n            \"remove_javascript_form_validation\":false,\r\n            \"remove_object_tags\":false,\r\n            \"remove_secure_flag_from_cookies\":false,\r\n            \"unhide_hidden_form_fields\":false\r\n        },\r\n        \"ssl_pass_through\":{\r\n            \"automatically_add_entries_on_client_ssl_negotiation_failure\":false,\r\n            \"rules\":[]\r\n        },\r\n        \"web_sockets_history_display_filter\":{\r\n            \"by_annotation\":{\r\n                \"show_only_commented_items\":false,\r\n                \"show_only_highlighted_items\":false\r\n            },\r\n            \"by_listener\":{\r\n                \"listener_port\":\"\"\r\n            },\r\n            \"by_request_type\":{\r\n                \"hide_incoming_messages\":false,\r\n                \"hide_outgoing_messages\":false,\r\n                \"show_only_in_scope_items\":false\r\n            }\r\n        }\r\n    },\r\n    \"repeater\":{\r\n        \"follow_redirections\":\"never\",\r\n        \"process_cookies_in_redirections\":false,\r\n        \"unpack_gzip_deflate\":true,\r\n        \"update_content_length\":true\r\n    },\r\n    \"sequencer\":{\r\n        \"live_capture\":{\r\n            \"ignore_abnormal_length_tokens\":true,\r\n            \"max_length_deviation\":5,\r\n            \"num_threads\":5,\r\n            \"throttle\":0\r\n        },\r\n        \"token_analysis\":{\r\n            \"compression\":true,\r\n            \"correlation\":true,\r\n            \"count\":true,\r\n            \"fips_long_run\":true,\r\n            \"fips_monobit\":true,\r\n            \"fips_poker\":true,\r\n            \"fips_runs\":true,\r\n            \"spectral\":true,\r\n            \"transitions\":true\r\n        },\r\n        \"token_handling\":{\r\n            \"base_64_decode_before_analyzing\":false,\r\n            \"pad_short_tokens_at\":\"start\",\r\n            \"pad_with\":\"0\"\r\n        }\r\n    },\r\n    \"spider\":{\r\n        \"application_login\":{\r\n            \"mode\":\"prompt\",\r\n            \"password\":\"\",\r\n            \"username\":\"\"\r\n        },\r\n        \"crawler\":{\r\n            \"check_robots_text\":true,\r\n            \"detect_custom_not_found_responses\":true,\r\n            \"ignore_links_to_non_text_content\":true,\r\n            \"make_non_parameterized_request_to_dynamic_pages\":true,\r\n            \"max_link_depth\":5,\r\n            \"max_parameterized_requests_per_url\":50,\r\n            \"request_root_of_all_directories\":true\r\n        },\r\n        \"engine\":{\r\n            \"add_random_variation_to_throttle\":false,\r\n            \"number_of_retries_on_failure\":3,\r\n            \"number_of_threads\":10,\r\n            \"pause_before_retry_on_failure\":2000,\r\n            \"throttle_between_requests\":false,\r\n            \"throttle_interval\":0\r\n        },\r\n        \"form_submission\":{\r\n            \"default_auto_fill_value\":\"555-555-0199@example.com\",\r\n            \"individuate_forms_by\":\"action_url_method_and_fields\",\r\n            \"iterate_all_values_of_submit_fields\":true,\r\n            \"max_submissions_per_form\":10,\r\n            \"mode\":\"automatic\",\r\n            \"param_auto_fill_rules\":[\r\n                {\r\n                    \"enabled\":true,\r\n                    \"field_name\":\"mail\",\r\n                    \"field_value\":\"winter@example.com\",\r\n                    \"match_type\":\"regex\"\r\n                },\r\n                {\r\n                    \"enabled\":true,\r\n                    \"field_name\":\"first\",\r\n                    \"field_value\":\"Peter\",\r\n                    \"match_type\":\"regex\"\r\n                },\r\n                {\r\n                    \"enabled\":true,\r\n                    \"field_name\":\"last\",\r\n                    \"field_value\":\"Winter\",\r\n                    \"match_type\":\"regex\"\r\n                },\r\n                {\r\n                    \"enabled\":true,\r\n                    \"field_name\":\"surname\",\r\n                    \"field_value\":\"Winter\",\r\n                    \"match_type\":\"regex\"\r\n                },\r\n                {\r\n                    \"enabled\":true,\r\n                    \"field_name\":\"name\",\r\n                    \"field_value\":\"Peter Winter\",\r\n                    \"match_type\":\"regex\"\r\n                },\r\n                {\r\n                    \"enabled\":true,\r\n                    \"field_name\":\"comp\",\r\n                    \"field_value\":\"Winter Consulting\",\r\n                    \"match_type\":\"regex\"\r\n                },\r\n                {\r\n                    \"enabled\":true,\r\n                    \"field_name\":\"addr\",\r\n                    \"field_value\":\"1 Main Street\",\r\n                    \"match_type\":\"regex\"\r\n                },\r\n                {\r\n                    \"enabled\":true,\r\n                    \"field_name\":\"city\",\r\n                    \"field_value\":\"Winterville\",\r\n                    \"match_type\":\"regex\"\r\n                },\r\n                {\r\n                    \"enabled\":true,\r\n                    \"field_name\":\"state\",\r\n                    \"field_value\":\"WI\",\r\n                    \"match_type\":\"regex\"\r\n                },\r\n                {\r\n                    \"enabled\":true,\r\n                    \"field_name\":\"zip\",\r\n                    \"field_value\":\"36310\",\r\n                    \"match_type\":\"regex\"\r\n                },\r\n                {\r\n                    \"enabled\":true,\r\n                    \"field_name\":\"post\",\r\n                    \"field_value\":\"SW1A 1AA\",\r\n                    \"match_type\":\"regex\"\r\n                },\r\n                {\r\n                    \"enabled\":true,\r\n                    \"field_name\":\"area\",\r\n                    \"field_value\":\"555\",\r\n                    \"match_type\":\"regex\"\r\n                },\r\n                {\r\n                    \"enabled\":true,\r\n                    \"field_name\":\"phone\",\r\n                    \"field_value\":\"555-555-0199\",\r\n                    \"match_type\":\"regex\"\r\n                },\r\n                {\r\n                    \"enabled\":true,\r\n                    \"field_name\":\"tel\",\r\n                    \"field_value\":\"555-555-0199\",\r\n                    \"match_type\":\"regex\"\r\n                },\r\n                {\r\n                    \"enabled\":true,\r\n                    \"field_name\":\"ssn\",\r\n                    \"field_value\":\"123 45 6789\",\r\n                    \"match_type\":\"regex\"\r\n                },\r\n                {\r\n                    \"enabled\":true,\r\n                    \"field_name\":\"social\",\r\n                    \"field_value\":\"123 45 6789\",\r\n                    \"match_type\":\"regex\"\r\n                },\r\n                {\r\n                    \"enabled\":true,\r\n                    \"field_name\":\"age\",\r\n                    \"field_value\":\"30\",\r\n                    \"match_type\":\"regex\"\r\n                },\r\n                {\r\n                    \"enabled\":true,\r\n                    \"field_name\":\"day\",\r\n                    \"field_value\":\"01\",\r\n                    \"match_type\":\"regex\"\r\n                },\r\n                {\r\n                    \"enabled\":true,\r\n                    \"field_name\":\"month\",\r\n                    \"field_value\":\"01\",\r\n                    \"match_type\":\"regex\"\r\n                },\r\n                {\r\n                    \"enabled\":true,\r\n                    \"field_name\":\"year\",\r\n                    \"field_value\":\"1980\",\r\n                    \"match_type\":\"regex\"\r\n                },\r\n                {\r\n                    \"enabled\":true,\r\n                    \"field_name\":\"passport\",\r\n                    \"field_value\":\"0123456789\",\r\n                    \"match_type\":\"regex\"\r\n                }\r\n            ],\r\n            \"set_unmatched_fields\":true\r\n        },\r\n        \"passive_spidering\":{\r\n            \"link_depth_to_associate_with_proxy_requests\":0,\r\n            \"passively_spider_as_you_browse\":true\r\n        },\r\n        \"request_headers\":{\r\n            \"custom_headers\":[\r\n                \"Accept: *\/*\",\r\n                \"Accept-Language: en\",\r\n                \"User-Agent: Mozilla\/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident\/5.0)\",\r\n                \"Connection: close\"\r\n            ],\r\n            \"use_http_11\":true,\r\n            \"use_referer\":true\r\n        },\r\n        \"scope\":{\r\n            \"advanced_mode\":false,\r\n            \"exclude\":[],\r\n            \"include\":[],\r\n            \"scope_option\":\"suite\"\r\n        }\r\n    },\r\n    \"target\":{\r\n        \"filter\":{\r\n            \"by_annotation\":{\r\n                \"show_only_commented_items\":false,\r\n                \"show_only_highlighted_items\":false\r\n            },\r\n            \"by_file_extension\":{\r\n                \"hide_items\":[\r\n                    \"js\",\r\n                    \"gif\",\r\n                    \"jpg\",\r\n                    \"png\",\r\n                    \"css\"\r\n                ],\r\n                \"hide_specific\":false,\r\n                \"show_items\":[\r\n                    \"asp\",\r\n                    \"aspx\",\r\n                    \"jsp\",\r\n                    \"php\"\r\n                ],\r\n                \"show_only_specific\":false\r\n            },\r\n            \"by_folders\":{\r\n                \"hide_empty_folders\":true\r\n            },\r\n            \"by_mime_type\":{\r\n                \"show_css\":false,\r\n                \"show_flash\":true,\r\n                \"show_html\":true,\r\n                \"show_images\":false,\r\n                \"show_other_binary\":false,\r\n                \"show_other_text\":true,\r\n                \"show_script\":true,\r\n                \"show_xml\":true\r\n            },\r\n            \"by_request_type\":{\r\n                \"hide_not_found_items\":true,\r\n                \"show_only_in_scope_items\":false,\r\n                \"show_only_parameterized_requests\":false,\r\n                \"show_only_requested_items\":false\r\n            },\r\n            \"by_search\":{\r\n                \"case_sensitive\":false,\r\n                \"negative_search\":false,\r\n                \"regex\":false,\r\n                \"term\":\"\"\r\n            },\r\n            \"by_status_code\":{\r\n                \"show_2xx\":true,\r\n                \"show_3xx\":true,\r\n                \"show_4xx\":false,\r\n                \"show_5xx\":true\r\n            }\r\n        },\r\n        \"scope\":{\r\n            \"advanced_mode\":false,\r\n            \"exclude\":[],\r\n            \"include\":[]\r\n        }\r\n    }\r\n}";
    fs.writeFile('options.json', burpConfigFile, function (err) {
        if (err) {
            console.log(err);
            res.json({
                status: "fail",
                message: 'Could not write file',
            })
        } else {
            //File has been written
            //execute command to run burp with settings from file written above
            res.json({
                status: "success",
                message: 'Proxy started. Currently replaces all responses. ' + findString + ' is being replaced with ' + replaceString,
            })
            exec('java -jar -Djava.awt.headless=true ~/burp.jar --config-file="options.json"', (error, stdout, stderr) => {
            });


        }
    })

});
module.exports = router;